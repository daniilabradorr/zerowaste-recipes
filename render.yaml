services:
  - type: web
    name: zerowaste-recipes
    env: python
    plan: free

    # Instalamos dependencias
    buildCommand: |
      pip install -r requirements.txt

    # Aplicamos migraciones antes de recoger est√°ticos
    preDeployCommand: |
      python manage.py migrate --noinput
      python manage.py collectstatic --noinput --clear

    # Arrancamos Gunicorn en el puerto asignado por Render
    startCommand: |
      gunicorn zerowaste.wsgi \
        --workers 3 \
        --bind 0.0.0.0:$PORT \
        --log-file -

    # Opcional: health check
    healthCheckPath: "/"
    healthCheckIntervalSeconds: 15